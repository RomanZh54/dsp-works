Fd = 20e3;                      %??????? ?????????????
W1 = 3e3 / (0.5 * Fd);          %????? ??????? ?????????? ??????? 3???
W2 = 5e3 / (0.5 * Fd);          %?????? ??????? ?????????? ??????? 5???
f = 0 : 10e3;                   %?????? ?????? ?? ??????? ?????????
n = 20;                         %??????? ???????
k = hann(n + 1);                %?????????? ????? ?????
b = fir1(n, [W1 W2], k);        %?????????? ???????????? ???????
hi = impz(b, 1);                %?????????? ?????????? ??????????????
subplot(2, 1, 1);
stem(hi);                       %????????? ???. ???-??
grid on
subplot(2, 1, 2);
plot(k);                        %????????? ?????
grid on

h = freqz(b, 1, f, Fd);         %?????????? ??? ???????
figure
plot(f, abs(h))                 %????????? ???
grid on
xlabel('Frequency, Hz')
legend ('Frequency responce')

tau_phase = unwrap(angle(h));   %?????????? ??? ???????
figure
plot(f, tau_phase)              %????????? ???
grid on
ylabel('Phase, rad')
xlabel('Frequency, Hz')
legend ('Phase responce')

t = 0 : 1 / Fd : 0.1 * pi
clear_sin = sin(2 * pi * 4e3 * t)
sig = sin(2 * pi * 4e3 * t) + sin(2 * pi * 10e3 * t) + sin(2 * pi * 2e3 * t)
sig_after_filter = filter(b, 1, sig)

figure
subplot(3, 1, 1);
plot(sig(50 : 100));
title('input signal');
subplot(3, 1, 2);
plot(clear_sin(50 : 100));
title('clear signal');
subplot(3, 1, 3);
plot(sig_after_filter(50 : 100));
title('after filter');

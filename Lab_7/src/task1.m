Fd = 20e3;                      %??????? ?????????????
W1 = 3e3 / (0.5 * Fd);          %????? ??????? ?????????? ??????? 3???
W2 = 5e3 / (0.5 * Fd);          %?????? ??????? ?????????? ??????? 5???
f = 0 : 10e3;                   %?????? ?????? ?? ??????? ?????????
n = 20;                         %??????? ???????
k = hann(n + 1);                %?????????? ????? ?????
b = fir1(n, [W1 W2], k);        %?????????? ???????????? ???????
hi = impz(b, 1);                %?????????? ?????????? ??????????????
subplot(2, 1, 1);
stem(hi);                       %????????? ???. ???-??
grid on
subplot(2, 1, 2);
plot(k);                        %????????? ?????
grid on

h = freqz(b, 1, f, Fd);         %?????????? ??? ???????
figure
plot(f, abs(h))                 %????????? ???
grid on
xlabel('Frequency, Hz')
legend ('Frequency responce')

tau_phase = unwrap(angle(h));   %?????????? ??? ???????
figure
plot(f, tau_phase)              %????????? ???
grid on
ylabel('Phase, rad')
xlabel('Frequency, Hz')
legend ('Phase responce')
